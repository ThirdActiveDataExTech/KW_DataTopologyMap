<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default2}">

<th:block layout:fragment="center-image">
  <th:block th:with="title1=${currentPageName}, title2=${navigation}, leftImg=${centerLeftImage}, rightImg=${centerRightImage}">
    <th:block th:replace="fragments/center-image :: main-image-title-no-header(${title1}, ${title2}, ${leftImg}, ${rightImg})"></th:block>
  </th:block>
</th:block>

<th:block layout:fragment="head">
  <style>
    :root{
      --card:#ffffff;
      --muted:#6b7280;
      --accent:#0b69ff;
      --gap:18px;
      --radius:12px;
      font-family: "Noto Sans KR", Arial, sans-serif;
    }

    .container{
      max-width:1300px;
      margin:0 auto;
    }

    /* 메뉴 (아이콘 그리드) */
    .category-menu{
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:22px;
    }
    .category-menu .tabs{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .tab {
      padding:8px 12px;
      background:transparent;
      border-radius:8px;
      cursor:pointer;
      color:var(--muted);
      font-weight:600;
    }
    .tab.active{
      color:var(--accent);
      background:#eef6ff;
      border:1px solid rgba(11,105,255,0.08);
    }

    .icon-grid{
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      margin-top:12px;
      margin-bottom:18px;
      justify-content: center;
    }
    .icon-item{
      width:110px;
      min-width:110px;
      background:var(--card);
      border-radius:10px;
      padding:14px;
      box-shadow:0 1px 3px rgba(16,24,40,0.04);
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      gap:8px;
      cursor: pointer;
    }
    .icon{
      width:48px;
      height:48px;
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#eef2ff;
      font-weight:700;
      color:var(--accent);
    }
    .icon-label{
      font-size:13px;
      color:#111827;
    }

    /* 메인 그리드(3~8번) */
    .grid{
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      grid-auto-rows: auto;   /* ✅ minmax 말고 auto */
      height: auto !important; /* ✅ 강제로 auto */
      gap: 18px;
    }

    /* 박스 공통 */
    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:0 1px 4px rgba(16,24,40,0.04);
    }
    .card h3{
      margin:0 0 10px 0;
      font-size: 16px;
      font-weight: bold;
    }
    .card .more{
      color:var(--muted);
      font-size:13px;
      cursor: pointer;
    }

    /* 인기 키워드 (3) - 큰 비주얼 박스 */
    .popular-keywords{
      grid-column: 1 / span 5;
      grid-row: 1 / span 2;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .treemap-placeholder{
      flex:1;
      background:linear-gradient(90deg,#fef3c7,#f0f9ff);
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#374151;
      font-weight:700;
      min-height:180px;
    }

    /* 인기 데이터 (4) */
    .popular-data{
      grid-column: 6 / span 4;
      grid-row: 1 / span 1;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .popular-data ul{
      list-style:none;
      margin:0;
      padding:0;
    }
    .popular-data li{
      display:flex;
      gap:10px;
      padding:8px 6px;
      align-items:flex-start;
      border-bottom:1px dashed #f0f0f0;
    }
    .popular-data li .idx{
      width:28px;
      font-weight:700;
      color:var(--accent);
    }
    .popular-data li .title{
      font-size:14px;
    }

    /* 공지사항 (5) */
    .notice{
      grid-column: 10 / span 3;
      grid-row: 1 / span 1;
    }
    .notice ul{margin:0;padding:0;list-style:none}
    .notice li{padding:10px 6px;border-bottom:1px solid #f3f4f6;cursor: pointer}
    .notice li .meta{font-size:12px;color:var(--muted)}

    /* 신규 데이터 (6) */
    .new-data{
      grid-column: 1 / span 6;
      grid-row: 3 / span 1;
      min-height:160px;
    }
    .new-grid{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .new-item{
      width:calc(33.333% - 6.666px);
      min-width:150px;
      background:#fafafa;
      padding:12px;
      border-radius:8px;
      border:1px solid #f3f4f6;
    }

    /* 전체 데이터 현황 (7) */
    .stats{
      grid-column: 7 / span 3;
      grid-row: 3 / span 1;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .stat-row{
      background:#f8fafc;
      padding:12px;
      border-radius:8px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .stat-row .label{font-size:13px;color:var(--muted)}
    .stat-row .value{font-weight:800;font-size:18px;color:#0f172a}

    /* 자주찾는 질문 (8) */
    .faq{
      grid-column: 10 / span 3;
      grid-row: 3 / span 1;
    }
    .faq ul{list-style:none;margin:0;padding:0}
    .faq li{padding:10px 6px;border-bottom:1px solid #f3f4f6;cursor: pointer}

    /* 반응형 */
    @media (max-width:1000px){
      .popular-keywords{grid-column:1 / span 12}
      .popular-data{grid-column:1 / span 12}
      .notice{grid-column:1 / span 12}
      .new-data{grid-column:1 / span 12}
      .stats{grid-column:1 / span 12}
      .faq{grid-column:1 / span 12}
      .icon-item{width:80px; min-width:80px}
      .new-item{width:calc(50% - 6px)}
    }
    @media (max-width:560px){
      body{padding:16px;}
      .new-item{width:100%}
      .icon-grid{justify-content:flex-start}
    }
  </style>
  <style>
    /* 검색 영역 */
    .search-bar{
      display:flex;
      justify-content:center;
      align-items:center;
      margin-bottom:24px;
    }

    .search-box{
      display:flex;
      align-items:center;
      border:1px solid #d1d5db;
      border-radius:8px;
      overflow:hidden;
      width:100%;
      max-width:800px;
      background:#fff;
    }

    .search-select{
      border:none;
      border-right:1px solid #e5e7eb;
      padding:10px 12px;
      font-size:14px;
      background:#f9fafb;
      outline:none;
      width: 20% !important;
    }

    .search-input{
      flex:1;
      padding:10px 14px;
      border:none;
      outline:none;
      font-size:14px;
    }

    .search-button{
      background:var(--accent);
      color:#fff;
      padding:10px 28px;
      border:none;
      cursor:pointer;
      font-weight:600;
      font-size:14px;
    }
    .search-button:hover{
      background:#084ccc;
    }
  </style>
</th:block>

<th:block layout:fragment="content">
  <!-- BEGIN: Content-->
  <div class="related-product-area pb-100 pt-80" data-aos="fade-up" data-aos-delay="200">
    <div class="container">

      <!-- 검색 영역 -->
      <div class="search-bar">
        <div class="search-box">
          <select class="search-select" id="search-select">
            <option value="dataset">데이터 셋</option>
            <option value="api">API</option>
            <option value="document">문서</option>
          </select>
          <input type="text" class="search-input" id="search-input" placeholder="검색어를 입력하세요">
          <button class="search-button" id="search-button">검색</button>
        </div>
      </div>

      <!-- 상단 메뉴 탭(테마별 등) -->
      <div class="category-menu">
        <div class="tabs">
          <div class="tab active">테마별</div>
          <div class="tab">카테고리별</div>
          <div class="tab">제공기관유형별</div>
        </div>
      </div>

      <!-- 아이콘 그리드 (기관 아이콘들) -->
      <div class="icon-grid">
        <div class="icon-item" data-val="national">
          <div class="icon">국</div>
          <div class="icon-label">국가행정기관</div>
        </div>
        <div class="icon-item" data-val="local">
          <div class="icon">지</div>
          <div class="icon-label">지방자치단체</div>
        </div>
        <div class="icon-item" data-val="educational">
          <div class="icon">교</div>
          <div class="icon-label">교육행정기관</div>
        </div>
        <div class="icon-item" data-val="public">
          <div class="icon">공</div>
          <div class="icon-label">공공기관</div>
        </div>
        <div class="icon-item" data-val="autonomous">
          <div class="icon">자</div>
          <div class="icon-label">자치법정기관</div>
        </div>
        <div class="icon-item" data-val="research">
          <div class="icon">문</div>
          <div class="icon-label">문체/연구기관</div>
        </div>
      </div>

      <!-- 메인 그리드 (3~8) -->
      <div class="grid">

        <!-- 인기 키워드 -->
        <div class="card popular-keywords" aria-labelledby="popular-keywords-title">
          <h3 id="popular-keywords-title">인기 키워드</h3>
          <div class="treemap-placeholder" role="img" aria-label="인기 키워드 트리맵">
            Treemap Placeholder
          </div>
          <div class="more">실시간 인기 키워드 시각화</div>
        </div>

        <!-- 인기 데이터 -->
        <div class="card popular-data" aria-labelledby="popular-data-title">
          <h3 id="popular-data-title">인기 데이터</h3>
          <ul>
            <li>
              <span class="idx">1</span>
              <span class="title">2022년 인구 통계 (시군구별)</span>
            </li>
            <li>
              <span class="idx">2</span>
              <span class="title">대중교통 실시간 이용현황</span>
            </li>
            <li>
              <span class="idx">3</span>
              <span class="title">환경 대기질 관측치</span>
            </li>
          </ul>
          <div class="more" id="popular-data-more">더보기 ›</div>
        </div>

        <!-- 공지사항 -->
        <div class="card notice" aria-labelledby="notice-title">
          <h3 id="notice-title">공지사항</h3>
          <ul>
            <th:block th:if="${notice.isEmpty()}">
              <li data-val="N">
                <span>공지사항이 없습니다.</span>
              </li>
            </th:block>
            <th:block th:unless="${notice.isEmpty()}">
              <th:block th:each="bbsctt, bbscttStat : ${notice}">
                <li data-val="Y" th:data-uid="${bbsctt?.bbscttUid}">
                  <!--<strong>[점검]</strong>-->
                  <span th:text="${bbsctt?.bbscttNm}"></span>
                  <div class="meta" th:text="${bbsctt?.regDt}"></div>
                </li>
              </th:block>
            </th:block>
          </ul>
        </div>

        <!-- 신규 데이터 -->
        <div class="card new-data" aria-labelledby="new-data-title">
          <h3 id="new-data-title">신규 데이터</h3>
          <div class="new-grid">
            <div class="new-item">
              <div class="label">교통</div>
              <div class="title">도로 교통량(월별)</div>
              <div class="meta" style="font-size:12px;color:var(--muted);margin-top:8px">등록: 2025-08-10</div>
            </div>
            <div class="new-item">
              <div class="label">환경</div>
              <div class="title">소음 측정치(센서별)</div>
              <div class="meta" style="font-size:12px;color:var(--muted);margin-top:8px">등록: 2025-08-09</div>
            </div>
            <div class="new-item">
              <div class="label">복지</div>
              <div class="title">복지시설 현황</div>
              <div class="meta" style="font-size:12px;color:var(--muted);margin-top:8px">등록: 2025-08-06</div>
            </div>
          </div>
        </div>

        <!-- 전체 데이터 현황 -->
        <div class="card stats" aria-labelledby="stats-title">
          <h3 id="stats-title">전체 데이터 현황</h3>
          <div class="stat-row">
            <div class="label">공공데이터</div>
            <div class="value">8,080</div>
          </div>
          <div class="stat-row">
            <div class="label">서비스</div>
            <div class="value">16,117</div>
          </div>
          <div class="stat-row">
            <div class="label">OpenAPI</div>
            <div class="value">5,514</div>
          </div>
        </div>

        <!-- 이용문의 -->
        <div class="card faq" aria-labelledby="faq-title">
          <h3 id="faq-title">이용문의</h3>
          <ul>
            <th:block th:if="${manual.isEmpty()}">
              <li data-val="N">
                <span>이용문의가 없습니다.</span>
              </li>
            </th:block>
            <th:block th:unless="${manual.isEmpty()}">
              <th:block th:each="bbsctt, bbscttStat : ${notice}">
                <li data-val="Y" th:data-uid="${bbsctt?.bbscttUid}">
                  <strong>Q:</strong>
                  <span th:text="${bbsctt?.bbscttNm}"></span>
                  <div class="meta">
                    <span>A:</span>
                    <spqn th:text="${bbsctt?.regDt}"></spqn>
                  </div>
                </li>
              </th:block>
            </th:block>
          </ul>
        </div>

      </div> <!-- .grid -->
    </div>
  </div>
  <!-- END: Content-->
</th:block>

<th:block layout:fragment="script">
  <script th:src="@{'/assets/js/page/thirdeye/main/home.js'}"></script>
  <script th:inline="javascript">

    $(document).ready(function() {

      /* 검색 이벤트1 */
      $("#search-button").on('click', function () {
        homeJS.searchData();
      });

      /* 검색 이벤트2 */
      $("#search-input").on('keydown', function (e) {
        if(e.key === "Enter") {
          $("#search-button").click();
        }
      });

      /* 상단 아이콘 버튼 클릭 이벤트 */
      $(".icon-item").click(function() {
        const val = $(this).data("val");
        homeJS.iconItemClickEvent(val);
      });

      /* 인기 데이터 더보기 */
      $("#popular-data-more").on('click', function () {
        window.location.href = '/portal/list'
      });

      /* 공지사항 li 클릭 */
      $(".card.notice ul li").click(function() {
        if ($(this).data("val") === "Y") {
          const uid = $(this).data("uid");
          window.location.href = "/portal/bbs/notice/" + uid;
        }
      });

      /* 이용문의 li 클릭 */
      $(".card.faq ul li").click(function() {
        if ($(this).data("val") === "Y") {
          const uid = $(this).data("uid");
          window.location.href = "/portal/bbs/manual/" + uid;
        }
      });

    });

  </script>
</th:block>
</html>