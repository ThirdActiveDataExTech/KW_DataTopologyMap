<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cetusBookMark">

    <select id="getUserBookMarkList" parameterType="SearchUserBookMark" resultType="UserBookMarkList">
        /* cetusBookMark.getUserBookMarkList */
        SELECT CDB.USER_UID
              ,CDB.APPROVED_DATASET_UID AS APPROVED_UID
              ,CAD.METADATA_ID AS METADATA_ID
          FROM CETUS_DATASET_BOOKMARK CDB
          LEFT JOIN CETUS_APPROVED_DATASET CAD ON CAD.UID = CDB.APPROVED_DATASET_UID
         WHERE CDB.USER_UID = #{userUid}
         ORDER BY CDB.REG_DT DESC
    </select>

    <select id="isBookMarkExists" parameterType="SearchUserBookMarkToggle" resultType="boolean">
        /* cetusBookMark.isBookMarkExists */
        SELECT EXISTS (
            SELECT 1
              FROM CETUS_DATASET_BOOKMARK
             WHERE USER_UID = #{userUid}
               AND APPROVED_DATASET_UID = #{approvedUid}
        ) AS IS_WISH_EXISTS
    </select>

    <insert id="insert" parameterType="CetusBookMark">
        /* cetusBookMark.insert */
        INSERT INTO CETUS_DATASET_BOOKMARK (
              USER_UID
            , APPROVED_DATASET_UID
            , REG_UID
            , REG_DT
            , UPDT_UID
            , UPDT_DT
        ) VALUES (
              #{userUid}
            , #{approvedUid}
            , #{regUid}
            , NOW()
            , #{updtUid}
            , NOW()
        )
    </insert>

    <delete id="deleteBookMark" parameterType="CetusBookMark">
        /* cetusBookMark.deleteBookMark */
        DELETE FROM CETUS_DATASET_BOOKMARK
         WHERE USER_UID = #{userUid}
           AND APPROVED_DATASET_UID = #{approvedUid}
    </delete>

</mapper>
